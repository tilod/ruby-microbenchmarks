#!/usr/bin/env ruby
require 'microbenchmarks'
require 'gli'
require 'active_support/core_ext/string'

include GLI::App

benchmark_dir = Dir[File.expand_path('../benchmarks/*.rb', __dir__)]
benchmark_dir.each do |file|
  require file
  
  benchmark_name  = File.basename(file, '.rb')
  benchmark_class = "Microbenchmarks::#{benchmark_name.classify}".constantize

  desc      benchmark_class.get_short_desc
  long_desc benchmark_class.get_long_desc
  command   benchmark_name.to_sym do |c|
    c.action do |global_options, options, args|
       benchmark_class.run
    end
  end
end

desc      'Run all benchmarks'
long_desc 'Run all benchmarks available in the benchmark suite. The benchmarks
           are listed as commands.'
command   :all do |c|
  c.action do |global_options, options, args|
    
  end
end

exit run(ARGV)
